<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>聊天室後台</title>
</head>
<body>
  <h1>後台訊息管理</h1>
  <div id="admin-box"></div>

  <script>
    async function loadMessages() {
      const res = await fetch('/messages');
      const messages = await res.json();
      const box = document.getElementById('admin-box');
      box.innerHTML = messages.map(msg => `
        <div>
          <input value="${msg.text}" onchange="editMessage(${msg.id}, this.value)">
          <button onclick="deleteMessage(${msg.id})">刪除</button>
        </div>
      `).join('');
    }

    async function editMessage(id, newText) {
      await fetch(`/messages/${id}`, {
        method: 'PUT',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({ text: newText })
      });
      loadMessages();
    }

    async function deleteMessage(id) {
      await fetch(`/messages/${id}`, { method: 'DELETE' });
      loadMessages();
    }

    loadMessages();
    setInterval(loadMessages, 3000); // 每3秒更新
  </script>
</body>
</html>
